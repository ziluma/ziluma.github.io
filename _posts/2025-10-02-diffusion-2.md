---
layout: post
title: "Diffusion-II Flows"
date: 2025-10-02
math: true
published: false
---

To save time, I read these brilliant [lecture notes](https://arxiv.org/abs/2506.02070).

**Idea**: $X_0\sim p_{\rm init}$ e.g. $\mathcal{N}(0,I)$, flow by ODE or SDE $X_t$ so that $X_1\approx p_{\rm data}.$

$$
\begin{equation}
\tag{ODE}
dX_t = V^{\theta}_t(X_t)\,dt
\end{equation}
$$

$$
\begin{equation}
\tag{SDE}
dX_t = V^{\theta}_t(X_t)\,dt + \sigma_t\,dW_t
\end{equation}
$$

$V^{\theta}_t={\rm NN}(\theta,t)$ to be learned. 
$W_t$ denotes a Brownnian motion.

We need to find a target vector field $V^{\rm tgt}_t$
so that if $X_t$ is the flow of $V^{\rm tgt}_t$ then $X_0\sim p_{\rm init},X_1\sim p_{\rm data}$.
Then set up a loss of the form  $|V^\theta-V^{\rm tgt}|^2$.

### Theory

We write $X\sim p$ if $p$ is the pdf of $X$.

**Fokker-Planck Theorem**

- Suppose $dX_t=V_t(X_t)dt$ for some general $V_t$. Then $X_t\sim p_t$ iff.

$$
\partial_t p = -{\rm div}(Vp).
$$

- Suppose $dX_t=V_t(X_t)dt+\sigma_t(X_t)dW_t$. Then $X_t\sim p_t$ iff.

$$
\partial_t p = \tfrac{1}{2}\Delta(\sigma^2p) - {\rm div}(Vp).
$$

We only prove the SDE case.
For any test function $f=f(x)$, by Ito formula,

$$
\begin{align*}
df(X_t)
&=\nabla f\cdot dX_t + \tfrac{1}{2}\langle \nabla^2f,dX_t\cdot dX_t\rangle\\ 
&= 
\end{align*}
$$
